"use strict";const U=require("@codemirror/state"),t=require("@lezer/highlight"),m=require("markedit-api"),_=require("@codemirror/view"),p=require("@codemirror/language"),v=(r,n={})=>r??n,J=v(m.MarkEdit.userSettings),N=$("extension.markeditTheming"),Q=b(!1)?v(N.lightTheme):void 0,W=b(!0)?v(N.darkTheme):void 0;function $(r){return r===void 0?{}:v(J[r])}function j(r){return r.enabledMode??"both"}function b(r,n=j(N)){return["both",r?"dark":"light"].includes(n)}function X(r,n,e){const c=Y({lhs:e,rhs:r?W:Q});return{extensions:[...r?q(c,{dark:!0}):q(c),n].filter(o=>o!==void 0),colors:c}}function q(r,n){const e={},c=[],a=r.editor,o=r.highlight;a?.textColor&&(e["&"]??={},e["&"].color=a?.textColor,e[".cm-activeLineGutter"]={backgroundColor:a?.textColor}),a?.backgroundColor&&(e["&"]??={},e["&"].backgroundColor=a?.backgroundColor),a?.activeLineBackground&&(e[".cm-activeLine"]={backgroundColor:a?.activeLineBackground}),a?.caretColor&&(e[".cm-content"]={caretColor:a?.caretColor},e[".cm-cursor, .cm-dropCursor"]={borderLeftColor:a?.caretColor}),a?.selectionBackground&&(e["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:a?.selectionBackground}),a?.matchingBracketBackground&&(e["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:a?.matchingBracketBackground}),a?.gutterText&&(e[".cm-gutters"]??={},e[".cm-gutters"].color=a?.gutterText),a?.gutterBackground&&(e[".cm-gutters"]??={},e[".cm-gutters"].backgroundColor=a?.gutterBackground,e[".cm-gutters"].border="none"),a?.foldPlaceholderText&&(e[".cm-foldPlaceholder"]??={},e[".cm-foldPlaceholder"].color=a?.foldPlaceholderText),a?.foldPlaceholderBackground&&(e[".cm-foldPlaceholder"]??={},e[".cm-foldPlaceholder"].backgroundColor=a?.foldPlaceholderBackground,e[".cm-foldPlaceholder"].border="none"),a?.searchMatchBackground&&(e[".cm-searchMatch"]={backgroundColor:a?.searchMatchBackground}),a?.selectionMatchBackground&&(e[".cm-selectionMatch"]={backgroundColor:a?.selectionMatchBackground}),o?.heading&&c.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&c.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&c.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&c.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&c.push({tag:t.tags.quote,color:o?.quote}),o?.link&&c.push({tag:[t.tags.url,t.tags.link],color:o?.link}),o?.separator&&c.push({tag:[t.tags.definition(t.tags.name),t.tags.separator,t.tags.contentSeparator],color:o?.separator}),o?.comment&&c.push({tag:t.tags.comment,color:o?.comment}),o?.meta&&c.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&c.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&c.push({tag:[t.tags.atom,t.tags.bool],color:o?.atom}),o?.literal&&c.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&c.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&c.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&c.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&c.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&c.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&c.push({tag:t.tags.className,color:o?.class}),o?.macro&&c.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&c.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&c.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&c.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&c.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&c.push({tag:t.tags.processingInstruction,color:o?.instruction}),o?.invalid&&c.push({tag:t.tags.invalid,color:o?.invalid});const i=[];return Object.keys(e).length>0&&i.push(_.EditorView.theme(e,n)),c.length>0&&i.push(p.syntaxHighlighting(p.HighlightStyle.define(c))),i}function Y(r){return{editor:{...r.lhs?.editor,...r.rhs?.editor},highlight:{...r.lhs?.highlight,...r.rhs?.highlight},subtleEmphasis:r.rhs?.subtleEmphasis??r.lhs?.subtleEmphasis}}const s={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",emphasisElement:".cm-md-bold:not(.tok-meta), .cm-md-italic:not(.tok-meta), .cm-md-quote:not(.cm-md-quoteMark)",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark"},Z=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${s.lineGutter} {}
${s.foldGutter} {}
${s.visibleSpace} {}
${s.matchingBracket} {}
${s.activeIndicator} {}
${s.emphasisElement} {}
${s.accentColor} {}
${s.syntaxMarker} {}
`,G=window,tt=G.__extractStyleRules__??(r=>r.value?.rules),et=G.__extractHighlightSpecs__??(r=>r.value?.specs);function ot(r){const n=document.createElement("style");return n.textContent=r,document.head.appendChild(n),n}function rt(r){if(r.length===0)return[{},[]];const n=T(r);return[Object.fromEntries(n.flatMap(c=>{const a=tt(c)?.join(`
`)??"";return Object.entries(ct(a))})),n.flatMap(c=>et(c)??[])]}function O(r,n){return r.find(e=>!!(e.tag.toString().includes(n.toString())&&e.color!==void 0))?.color}function S(r,n,e){for(const[c,a]of Object.entries(r))if(c.includes(n)&&(e===void 0||!c.includes(e))){const o=a.background??a.backgroundColor;if(o!==void 0)return o}}function at(r){const n=r.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(n===null)return;const[e,c,a]=n.slice(1,4).map(Number);return`rgba(${e}, ${c}, ${a}, 0.6)`}function H(r){const n=a=>a!==null&&typeof a=="object";if(!n(r))return!0;const e=Object.entries(r),c=a=>a!=null;for(const[,a]of e)if(n(a)){if(!H(a))return!1}else if(c(a))return!1;return!0}function T(r){return Array.isArray(r)?r.flatMap(T):"extension"in r?T(r.extension):[r]}function ct(r){const n={},e=new CSSStyleSheet;e.replaceSync(r);for(const c of e.cssRules){const{style:a,selectorText:o}=c,{background:i,backgroundColor:u}=a;n[o]={},i.length>0&&(n[o].background=i),u.length>0&&(n[o].backgroundColor=u)}return n}function nt(r){const n=r.options?.settingsKey,e=j($(n));r.light!==void 0&&b(!1,e)&&(l().customThemes.light=r.light),r.dark!==void 0&&b(!0,e)&&(l().customThemes.dark=r.dark),typeof m.MarkEdit.editorView=="object"&&M(m.MarkEdit.editorView)}const k=window,l=()=>k.__markeditTheming__,I=matchMedia("(prefers-color-scheme: dark)");typeof l()!="object"&&st();function st(){k.__markeditTheming__={styleSheet:ot(Z),configurator:new U.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},m.MarkEdit.addExtension(l().configurator.of([])),m.MarkEdit.onEditorReady(n=>M(n));const r=()=>setTimeout(()=>M(m.MarkEdit.editorView),15);I.addEventListener("change",r),l().mainThemeName=k.config.theme,Object.defineProperty(k.config,"theme",{get(){return l().mainThemeName},set(n){l().mainThemeName=n,r()}})}function M(r){const n=I.matches,e=n?l().customThemes.dark:l().customThemes.light,{extensions:c,colors:a}=X(n,e?.extension,e?.colors);r.dispatch({effects:l().configurator.reconfigure(c)});const[o,i]=rt(c),u=c.length===0&&H(a);l().styleSheet.disabled=u,it(r,n,u,o,i,a)}function it(r,n,e,c,a,o){const i=S(c,".cm-activeLine",".cm-activeLineGutter"),u=S(c,s.selectionBackground),C=S(c,s.matchingBracket),h=getComputedStyle(r.contentDOM).color,E=o.editor?.visibleSpaceColor??at(h),L=O(a,t.tags.heading),F=O(a,t.tags.processingInstruction),D=[[s.activeIndicator,i,"background"],[s.matchingBracket,C,"background"],[s.lineGutter,h,"color"],[s.foldGutter,E,"color"],[s.visibleSpace,E,"color"],[s.accentColor,L,"color"],[s.syntaxMarker,F,"color"]],V=Array.from(document.querySelectorAll("style")),f=n?l().darkOriginalRules:l().lightOriginalRules;for(const A of V){const B=A.sheet?.cssRules;if(B!==void 0)for(let x=0;x<B.length;++x){const g=B[x],d=g.selectorText??"";d.includes(".cm-focused")&&d.includes(s.selectionBackground)&&(f.selectionBackground??=g.cssText,e?g.cssText=f.selectionBackground:u!==void 0&&g.style.setProperty("background",u,"important")),L!==void 0&&(d===".cm-md-header"||d===".cm-md-header:not(.cm-md-quote)")&&(f.markdownHeader??=g.cssText,e?g.cssText=f.markdownHeader:g.style.removeProperty("color"));for(const[K,w,P]of D)if(d===K)if(w===void 0)g.style.removeProperty(P);else{const z=[s.accentColor,s.syntaxMarker].includes(d)?void 0:"important";g.style.setProperty(P,w,z),(d===s.matchingBracket||d===s.activeIndicator)&&g.style.setProperty("box-shadow","unset","important")}d===s.emphasisElement&&(o.subtleEmphasis??!0?g.style.setProperty("color","inherit","important"):g.style.removeProperty("color"))}}}function y(){return y=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var c in e)({}).hasOwnProperty.call(e,c)&&(r[c]=e[c])}return r},y.apply(null,arguments)}var R=r=>{var{theme:n,settings:e={},styles:c=[]}=r,a={".cm-gutters":{}},o={};e.background&&(o.backgroundColor=e.background),e.backgroundImage&&(o.backgroundImage=e.backgroundImage),e.foreground&&(o.color=e.foreground),e.fontSize&&(o.fontSize=e.fontSize),(e.background||e.foreground)&&(a["&"]=o),e.fontFamily&&(a["&.cm-editor .cm-scroller"]={fontFamily:e.fontFamily}),e.gutterBackground&&(a[".cm-gutters"].backgroundColor=e.gutterBackground),e.gutterForeground&&(a[".cm-gutters"].color=e.gutterForeground),e.gutterBorder&&(a[".cm-gutters"].borderRightColor=e.gutterBorder),e.caret&&(a[".cm-content"]={caretColor:e.caret},a[".cm-cursor, .cm-dropCursor"]={borderLeftColor:e.caret});var i={};e.gutterActiveForeground&&(i.color=e.gutterActiveForeground),e.lineHighlight&&(a[".cm-activeLine"]={backgroundColor:e.lineHighlight},i.backgroundColor=e.lineHighlight),a[".cm-activeLineGutter"]=i,e.selection&&(a["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:e.selection+" !important"}),e.selectionMatch&&(a["& .cm-selectionMatch"]={backgroundColor:e.selectionMatch});var u=_.EditorView.theme(a,{dark:n==="dark"}),C=p.HighlightStyle.define(c),h=[u,p.syntaxHighlighting(C)];return h},lt={background:"#faf8f5",foreground:"#b29762",caret:"#93abdc",selection:"#e3dcce",selectionMatch:"#e3dcce",gutterBackground:"#faf8f5",gutterForeground:"#cdc4b1",gutterBorder:"transparent",lineHighlight:"#ddceb154"},gt=[{tag:[t.tags.comment,t.tags.bracket],color:"#b6ad9a"},{tag:[t.tags.atom,t.tags.number,t.tags.keyword,t.tags.link,t.tags.attributeName,t.tags.quote],color:"#063289"},{tag:[t.tags.emphasis,t.tags.heading,t.tags.tagName,t.tags.propertyName,t.tags.variableName],color:"#2d2006"},{tag:[t.tags.typeName,t.tags.url,t.tags.string],color:"#896724"},{tag:[t.tags.operator,t.tags.string],color:"#1659df"},{tag:[t.tags.propertyName],color:"#b29762"},{tag:[t.tags.unit,t.tags.punctuation],color:"#063289"}],ut=r=>{var{theme:n="light",settings:e={},styles:c=[]}={};return R({theme:n,settings:y({},lt,e),styles:[...gt,...c]})},dt=ut(),mt={background:"#2a2734",foreground:"#6c6783",caret:"#ffad5c",selection:"#91ff6c26",selectionMatch:"#91ff6c26",gutterBackground:"#2a2734",gutterForeground:"#545167",lineHighlight:"#36334280"},ht=[{tag:[t.tags.comment,t.tags.bracket],color:"#6c6783"},{tag:[t.tags.atom,t.tags.number,t.tags.keyword,t.tags.link,t.tags.attributeName,t.tags.quote],color:"#ffcc99"},{tag:[t.tags.emphasis,t.tags.heading,t.tags.tagName,t.tags.propertyName,t.tags.className,t.tags.variableName],color:"#eeebff"},{tag:[t.tags.typeName,t.tags.url],color:"#7a63ee"},{tag:t.tags.operator,color:"#ffad5c"},{tag:t.tags.string,color:"#ffb870"},{tag:[t.tags.propertyName],color:"#9a86fd"},{tag:[t.tags.unit,t.tags.punctuation],color:"#e09142"}],ft=r=>{var{theme:n="dark",settings:e={},styles:c=[]}={};return R({theme:n,settings:y({},mt,e),styles:[...ht,...c]})},kt=ft();nt({light:{extension:dt},dark:{extension:kt},options:{settingsKey:"extension.markeditThemeDuoTone"}});
