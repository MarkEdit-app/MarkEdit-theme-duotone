"use strict";const j=require("@codemirror/state"),t=require("@lezer/highlight"),m=require("markedit-api"),G=require("@codemirror/view"),B=require("@codemirror/language"),c={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",emphasisElement:".cm-md-bold:not(.tok-meta), .cm-md-italic:not(.tok-meta), .cm-md-quote:not(.cm-md-quoteMark)",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark"},I=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${c.lineGutter} {}
${c.foldGutter} {}
${c.visibleSpace} {}
${c.matchingBracket} {}
${c.activeIndicator} {}
${c.emphasisElement} {}
${c.accentColor} {}
${c.syntaxMarker} {}
`,N=window,P=N.__extractStyleRules__??(r=>r.value?.rules),D=N.__extractHighlightSpecs__??(r=>r.value?.specs);function F(r){const o=document.createElement("style");return o.textContent=r,document.head.appendChild(o),o}function A(r){if(r===void 0)return[{},[]];const o=U(r);return[Object.fromEntries(o.flatMap(n=>{const a=P(n)?.join(`
`)??"";return Object.entries(J(a))})),o.flatMap(n=>D(n)??[])]}function V(r,o){return r.some(e=>e.tag.toString().includes(o.toString())?e.color!==void 0:!1)}function S(r,o){for(const[e,n]of Object.entries(r))if(e.includes(o)){const a=n.background??n.backgroundColor;if(a!==void 0)return a}}function z(r){const o=r.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(o===null)return;const[e,n,a]=o.slice(1,4).map(Number);return`rgba(${e}, ${n}, ${a}, 0.6)`}function U(r){const o=[],e=[r];for(;e.length>0;){const n=e.pop();Array.isArray(n)?n.forEach(a=>e.push(a)):"extension"in n?e.push(n.extension):o.push(n)}return o}function J(r){const o={},e=new CSSStyleSheet;e.replaceSync(r);for(const n of e.cssRules){const{style:a,selectorText:i}=n,{background:g,backgroundColor:d}=a;o[i]={},g.length>0&&(o[i].background=g),d.length>0&&(o[i].backgroundColor=d)}return o}function K(r){r.light!==void 0&&(s().customThemes.light=r.light),r.dark!==void 0&&(s().customThemes.dark=r.dark),typeof m.MarkEdit.editorView=="object"&&x(m.MarkEdit.editorView)}const k=window,s=()=>k.__markeditTheming__,_=matchMedia("(prefers-color-scheme: dark)");typeof s()!="object"&&Q();function Q(){k.__markeditTheming__={styleSheet:F(I),configurator:new j.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},m.MarkEdit.addExtension(s().configurator.of([])),m.MarkEdit.onEditorReady(o=>x(o));const r=()=>setTimeout(()=>x(m.MarkEdit.editorView),15);_.addEventListener("change",r),s().mainThemeName=k.config.theme,Object.defineProperty(k.config,"theme",{get(){return s().mainThemeName},set(o){s().mainThemeName=o,r()}})}function x(r){const o=_.matches,e=o?s().customThemes.dark:s().customThemes.light;r.dispatch({effects:s().configurator.reconfigure(e?.extension??[])});const[n,a]=A(e?.extension),i=e===void 0;s().styleSheet.disabled=i,W(r,o,i,n,a,e?.colors)}function W(r,o,e,n,a,i){const g=S(n,".cm-activeLine"),d=S(n,c.selectionBackground),p=S(n,c.matchingBracket),f=getComputedStyle(r.contentDOM).color,T=i?.visibleSpace??z(f),$=V(a,t.tags.heading),q=[[c.activeIndicator,g,"background"],[c.matchingBracket,p,"background"],[c.lineGutter,f,"color"],[c.foldGutter,T,"color"],[c.visibleSpace,T,"color"],[c.accentColor,i?.accentColor,"color"],[c.syntaxMarker,i?.syntaxMarker,"color"]],O=Array.from(document.querySelectorAll("style")),h=o?s().darkOriginalRules:s().lightOriginalRules;for(const H of O){const y=H.sheet?.cssRules;if(y!==void 0)for(let v=0;v<y.length;++v){const l=y[v],u=l.selectorText??"";u.includes(".cm-focused")&&u.includes(c.selectionBackground)&&(h.selectionBackground??=l.cssText,e?l.cssText=h.selectionBackground:d!==void 0&&l.style.setProperty("background",d,"important")),$&&(u===".cm-md-header"||u===".cm-md-header:not(.cm-md-quote)")&&(h.markdownHeader??=l.cssText,e?l.cssText=h.markdownHeader:l.style.removeProperty("color"));for(const[R,C,M]of q)u===R&&(C===void 0?l.style.removeProperty(M):(l.style.setProperty(M,C,"important"),(u===c.matchingBracket||u===c.activeIndicator)&&l.style.setProperty("box-shadow","unset","important")));u===c.emphasisElement&&(i?.subtleEmphasis??!0?l.style.setProperty("color","inherit","important"):l.style.removeProperty("color"))}}}function b(){return b=Object.assign?Object.assign.bind():function(r){for(var o=1;o<arguments.length;o++){var e=arguments[o];for(var n in e)({}).hasOwnProperty.call(e,n)&&(r[n]=e[n])}return r},b.apply(null,arguments)}var L=r=>{var{theme:o,settings:e={},styles:n=[]}=r,a={".cm-gutters":{}},i={};e.background&&(i.backgroundColor=e.background),e.backgroundImage&&(i.backgroundImage=e.backgroundImage),e.foreground&&(i.color=e.foreground),e.fontSize&&(i.fontSize=e.fontSize),(e.background||e.foreground)&&(a["&"]=i),e.fontFamily&&(a["&.cm-editor .cm-scroller"]={fontFamily:e.fontFamily}),e.gutterBackground&&(a[".cm-gutters"].backgroundColor=e.gutterBackground),e.gutterForeground&&(a[".cm-gutters"].color=e.gutterForeground),e.gutterBorder&&(a[".cm-gutters"].borderRightColor=e.gutterBorder),e.caret&&(a[".cm-content"]={caretColor:e.caret},a[".cm-cursor, .cm-dropCursor"]={borderLeftColor:e.caret});var g={};e.gutterActiveForeground&&(g.color=e.gutterActiveForeground),e.lineHighlight&&(a[".cm-activeLine"]={backgroundColor:e.lineHighlight},g.backgroundColor=e.lineHighlight),a[".cm-activeLineGutter"]=g,e.selection&&(a["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:e.selection+" !important"}),e.selectionMatch&&(a["& .cm-selectionMatch"]={backgroundColor:e.selectionMatch});var d=G.EditorView.theme(a,{dark:o==="dark"}),p=B.HighlightStyle.define(n),f=[d,B.syntaxHighlighting(p)];return f},X={background:"#faf8f5",foreground:"#b29762",caret:"#93abdc",selection:"#e3dcce",selectionMatch:"#e3dcce",gutterBackground:"#faf8f5",gutterForeground:"#cdc4b1",gutterBorder:"transparent",lineHighlight:"#ddceb154"},Y=[{tag:[t.tags.comment,t.tags.bracket],color:"#b6ad9a"},{tag:[t.tags.atom,t.tags.number,t.tags.keyword,t.tags.link,t.tags.attributeName,t.tags.quote],color:"#063289"},{tag:[t.tags.emphasis,t.tags.heading,t.tags.tagName,t.tags.propertyName,t.tags.variableName],color:"#2d2006"},{tag:[t.tags.typeName,t.tags.url,t.tags.string],color:"#896724"},{tag:[t.tags.operator,t.tags.string],color:"#1659df"},{tag:[t.tags.propertyName],color:"#b29762"},{tag:[t.tags.unit,t.tags.punctuation],color:"#063289"}],Z=r=>{var{theme:o="light",settings:e={},styles:n=[]}={};return L({theme:o,settings:b({},X,e),styles:[...Y,...n]})},ee=Z(),te={background:"#2a2734",foreground:"#6c6783",caret:"#ffad5c",selection:"#91ff6c26",selectionMatch:"#91ff6c26",gutterBackground:"#2a2734",gutterForeground:"#545167",lineHighlight:"#36334280"},oe=[{tag:[t.tags.comment,t.tags.bracket],color:"#6c6783"},{tag:[t.tags.atom,t.tags.number,t.tags.keyword,t.tags.link,t.tags.attributeName,t.tags.quote],color:"#ffcc99"},{tag:[t.tags.emphasis,t.tags.heading,t.tags.tagName,t.tags.propertyName,t.tags.className,t.tags.variableName],color:"#eeebff"},{tag:[t.tags.typeName,t.tags.url],color:"#7a63ee"},{tag:t.tags.operator,color:"#ffad5c"},{tag:t.tags.string,color:"#ffb870"},{tag:[t.tags.propertyName],color:"#9a86fd"},{tag:[t.tags.unit,t.tags.punctuation],color:"#e09142"}],re=r=>{var{theme:o="dark",settings:e={},styles:n=[]}={};return L({theme:o,settings:b({},te,e),styles:[...oe,...n]})},ne=re();const w=(r,o={})=>r??o,ae=w(w(m.MarkEdit.userSettings)["extension.markeditThemeDuoTone"]),E=ae.enabledMode??"both",ce={extension:ee},ie={extension:ne};K({light:["both","light"].includes(E)?ce:void 0,dark:["both","dark"].includes(E)?ie:void 0});
