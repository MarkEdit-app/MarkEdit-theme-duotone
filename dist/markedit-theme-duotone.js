"use strict";const J=require("@codemirror/state"),t=require("@lezer/highlight"),m=require("markedit-api"),_=require("@codemirror/view"),p=require("@codemirror/language"),y=(r,c={})=>r??c,Q=y(m.MarkEdit.userSettings),S=y(Q["extension.markeditTheming"]),W=S.enabledMode??"both",O=y(S.lightTheme),G=y(S.darkTheme),H=r=>["both",r?"dark":"light"].includes(W),X=I(O),Y=I(G,{dark:!0});function Z(r,c){if(!H(r))return c;const e=r?Y:X;return e===void 0?c:[e,c].filter(a=>a!==void 0)}function tt(r,c){if(!H(r))return c;const e=r?G.custom:O.custom;return e===void 0?c:{...c,...e}}function I(r,c){const e={},a=[],n=r.editor,o=r.highlight;return n?.textColor&&(e["&"]??={},e["&"].color=n?.textColor,e[".cm-activeLineGutter"]={backgroundColor:n?.textColor}),n?.backgroundColor&&(e["&"]??={},e["&"].backgroundColor=n?.backgroundColor),n?.activeLineBackground&&(e[".cm-activeLine"]={backgroundColor:n?.activeLineBackground}),n?.caretColor&&(e[".cm-content"]={caretColor:n?.caretColor},e[".cm-cursor, .cm-dropCursor"]={borderLeftColor:n?.caretColor}),n?.selectionBackground&&(e["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:n?.selectionBackground}),n?.matchingBracketBackground&&(e["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:n?.matchingBracketBackground}),n?.gutterText&&(e[".cm-gutters"]??={},e[".cm-gutters"].color=n?.gutterText),n?.gutterBackground&&(e[".cm-gutters"]??={},e[".cm-gutters"].backgroundColor=n?.gutterBackground,e[".cm-gutters"].border="none"),n?.foldPlaceholderText&&(e[".cm-foldPlaceholder"]??={},e[".cm-foldPlaceholder"].color=n?.foldPlaceholderText),n?.foldPlaceholderBackground&&(e[".cm-foldPlaceholder"]??={},e[".cm-foldPlaceholder"].backgroundColor=n?.foldPlaceholderBackground,e[".cm-foldPlaceholder"].border="none"),n?.searchMatchBackground&&(e[".cm-searchMatch"]={backgroundColor:n?.searchMatchBackground}),n?.selectionMatchBackground&&(e[".cm-selectionMatch"]={backgroundColor:n?.selectionMatchBackground}),o?.heading&&a.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&a.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&a.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&a.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&a.push({tag:t.tags.quote,color:o?.quote}),o?.link&&a.push({tag:[t.tags.url,t.tags.link],color:o?.link}),o?.separator&&a.push({tag:[t.tags.definition(t.tags.name),t.tags.separator,t.tags.contentSeparator],color:o?.separator}),o?.comment&&a.push({tag:t.tags.comment,color:o?.comment}),o?.meta&&a.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&a.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&a.push({tag:[t.tags.atom,t.tags.bool],color:o?.atom}),o?.literal&&a.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&a.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&a.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&a.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&a.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&a.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&a.push({tag:t.tags.className,color:o?.class}),o?.macro&&a.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&a.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&a.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&a.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&a.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&a.push({tag:t.tags.processingInstruction,color:o?.instruction}),o?.invalid&&a.push({tag:t.tags.invalid,color:o?.invalid}),[_.EditorView.theme(e,c),p.syntaxHighlighting(p.HighlightStyle.define(a))]}const i={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",emphasisElement:".cm-md-bold:not(.tok-meta), .cm-md-italic:not(.tok-meta), .cm-md-quote:not(.cm-md-quoteMark)",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark"},et=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${i.lineGutter} {}
${i.foldGutter} {}
${i.visibleSpace} {}
${i.matchingBracket} {}
${i.activeIndicator} {}
${i.emphasisElement} {}
${i.accentColor} {}
${i.syntaxMarker} {}
`,j=window,ot=j.__extractStyleRules__??(r=>r.value?.rules),rt=j.__extractHighlightSpecs__??(r=>r.value?.specs);function at(r){const c=document.createElement("style");return c.textContent=r,document.head.appendChild(c),c}function ct(r){if(r===void 0)return[{},[]];const c=T(r);return[Object.fromEntries(c.flatMap(a=>{const n=ot(a)?.join(`
`)??"";return Object.entries(it(n))})),c.flatMap(a=>rt(a)??[])]}function E(r,c){return r.find(e=>!!(e.tag.toString().includes(c.toString())&&e.color!==void 0))?.color}function x(r,c,e){for(const[a,n]of Object.entries(r))if(a.includes(c)&&(e===void 0||!a.includes(e))){const o=n.background??n.backgroundColor;if(o!==void 0)return o}}function nt(r){const c=r.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(c===null)return;const[e,a,n]=c.slice(1,4).map(Number);return`rgba(${e}, ${a}, ${n}, 0.6)`}function T(r){return Array.isArray(r)?r.flatMap(T):"extension"in r?T(r.extension):[r]}function it(r){const c={},e=new CSSStyleSheet;e.replaceSync(r);for(const a of e.cssRules){const{style:n,selectorText:o}=a,{background:g,backgroundColor:u}=n;c[o]={},g.length>0&&(c[o].background=g),u.length>0&&(c[o].backgroundColor=u)}return c}function st(r){r.light!==void 0&&(s().customThemes.light=r.light),r.dark!==void 0&&(s().customThemes.dark=r.dark),typeof m.MarkEdit.editorView=="object"&&M(m.MarkEdit.editorView)}const k=window,s=()=>k.__markeditTheming__,R=matchMedia("(prefers-color-scheme: dark)");typeof s()!="object"&&lt();function lt(){k.__markeditTheming__={styleSheet:at(et),configurator:new J.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},m.MarkEdit.addExtension(s().configurator.of([])),m.MarkEdit.onEditorReady(c=>M(c));const r=()=>setTimeout(()=>M(m.MarkEdit.editorView),15);R.addEventListener("change",r),s().mainThemeName=k.config.theme,Object.defineProperty(k.config,"theme",{get(){return s().mainThemeName},set(c){s().mainThemeName=c,r()}})}function M(r){const c=R.matches,e=c?s().customThemes.dark:s().customThemes.light,a=Z(c,e?.extension),n=tt(c,e?.colors);r.dispatch({effects:s().configurator.reconfigure(a??[])});const[o,g]=ct(a),u=a===void 0;s().styleSheet.disabled=u,gt(r,c,u,o,g,n)}function gt(r,c,e,a,n,o){const g=x(a,".cm-activeLine",".cm-activeLineGutter"),u=x(a,i.selectionBackground),v=x(a,i.matchingBracket),h=getComputedStyle(r.contentDOM).color,N=o?.visibleSpace??nt(h),L=E(n,t.tags.heading),A=E(n,t.tags.processingInstruction),D=[[i.activeIndicator,g,"background"],[i.matchingBracket,v,"background"],[i.lineGutter,h,"color"],[i.foldGutter,N,"color"],[i.visibleSpace,N,"color"],[i.accentColor,o?.accentColor??L,"color"],[i.syntaxMarker,o?.syntaxMarker??A,"color"]],V=Array.from(document.querySelectorAll("style")),f=c?s().darkOriginalRules:s().lightOriginalRules;for(const z of V){const C=z.sheet?.cssRules;if(C!==void 0)for(let B=0;B<C.length;++B){const l=C[B],d=l.selectorText??"";d.includes(".cm-focused")&&d.includes(i.selectionBackground)&&(f.selectionBackground??=l.cssText,e?l.cssText=f.selectionBackground:u!==void 0&&l.style.setProperty("background",u,"important")),L!==void 0&&(d===".cm-md-header"||d===".cm-md-header:not(.cm-md-quote)")&&(f.markdownHeader??=l.cssText,e?l.cssText=f.markdownHeader:l.style.removeProperty("color"));for(const[U,w,$]of D)if(d===U)if(w===void 0)l.style.removeProperty($);else{const K=[i.accentColor,i.syntaxMarker].includes(d)?void 0:"important";l.style.setProperty($,w,K),(d===i.matchingBracket||d===i.activeIndicator)&&l.style.setProperty("box-shadow","unset","important")}d===i.emphasisElement&&(o?.subtleEmphasis??!0?l.style.setProperty("color","inherit","important"):l.style.removeProperty("color"))}}}function b(){return b=Object.assign?Object.assign.bind():function(r){for(var c=1;c<arguments.length;c++){var e=arguments[c];for(var a in e)({}).hasOwnProperty.call(e,a)&&(r[a]=e[a])}return r},b.apply(null,arguments)}var F=r=>{var{theme:c,settings:e={},styles:a=[]}=r,n={".cm-gutters":{}},o={};e.background&&(o.backgroundColor=e.background),e.backgroundImage&&(o.backgroundImage=e.backgroundImage),e.foreground&&(o.color=e.foreground),e.fontSize&&(o.fontSize=e.fontSize),(e.background||e.foreground)&&(n["&"]=o),e.fontFamily&&(n["&.cm-editor .cm-scroller"]={fontFamily:e.fontFamily}),e.gutterBackground&&(n[".cm-gutters"].backgroundColor=e.gutterBackground),e.gutterForeground&&(n[".cm-gutters"].color=e.gutterForeground),e.gutterBorder&&(n[".cm-gutters"].borderRightColor=e.gutterBorder),e.caret&&(n[".cm-content"]={caretColor:e.caret},n[".cm-cursor, .cm-dropCursor"]={borderLeftColor:e.caret});var g={};e.gutterActiveForeground&&(g.color=e.gutterActiveForeground),e.lineHighlight&&(n[".cm-activeLine"]={backgroundColor:e.lineHighlight},g.backgroundColor=e.lineHighlight),n[".cm-activeLineGutter"]=g,e.selection&&(n["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:e.selection+" !important"}),e.selectionMatch&&(n["& .cm-selectionMatch"]={backgroundColor:e.selectionMatch});var u=_.EditorView.theme(n,{dark:c==="dark"}),v=p.HighlightStyle.define(a),h=[u,p.syntaxHighlighting(v)];return h},ut={background:"#faf8f5",foreground:"#b29762",caret:"#93abdc",selection:"#e3dcce",selectionMatch:"#e3dcce",gutterBackground:"#faf8f5",gutterForeground:"#cdc4b1",gutterBorder:"transparent",lineHighlight:"#ddceb154"},dt=[{tag:[t.tags.comment,t.tags.bracket],color:"#b6ad9a"},{tag:[t.tags.atom,t.tags.number,t.tags.keyword,t.tags.link,t.tags.attributeName,t.tags.quote],color:"#063289"},{tag:[t.tags.emphasis,t.tags.heading,t.tags.tagName,t.tags.propertyName,t.tags.variableName],color:"#2d2006"},{tag:[t.tags.typeName,t.tags.url,t.tags.string],color:"#896724"},{tag:[t.tags.operator,t.tags.string],color:"#1659df"},{tag:[t.tags.propertyName],color:"#b29762"},{tag:[t.tags.unit,t.tags.punctuation],color:"#063289"}],mt=r=>{var{theme:c="light",settings:e={},styles:a=[]}={};return F({theme:c,settings:b({},ut,e),styles:[...dt,...a]})},ht=mt(),ft={background:"#2a2734",foreground:"#6c6783",caret:"#ffad5c",selection:"#91ff6c26",selectionMatch:"#91ff6c26",gutterBackground:"#2a2734",gutterForeground:"#545167",lineHighlight:"#36334280"},kt=[{tag:[t.tags.comment,t.tags.bracket],color:"#6c6783"},{tag:[t.tags.atom,t.tags.number,t.tags.keyword,t.tags.link,t.tags.attributeName,t.tags.quote],color:"#ffcc99"},{tag:[t.tags.emphasis,t.tags.heading,t.tags.tagName,t.tags.propertyName,t.tags.className,t.tags.variableName],color:"#eeebff"},{tag:[t.tags.typeName,t.tags.url],color:"#7a63ee"},{tag:t.tags.operator,color:"#ffad5c"},{tag:t.tags.string,color:"#ffb870"},{tag:[t.tags.propertyName],color:"#9a86fd"},{tag:[t.tags.unit,t.tags.punctuation],color:"#e09142"}],pt=r=>{var{theme:c="dark",settings:e={},styles:a=[]}={};return F({theme:c,settings:b({},ft,e),styles:[...kt,...a]})},bt=pt();const P=(r,c={})=>r??c,yt=P(P(m.MarkEdit.userSettings)["extension.markeditThemeDuoTone"]),q=yt.enabledMode??"both",vt={extension:ht},Ct={extension:bt};st({light:["both","light"].includes(q)?vt:void 0,dark:["both","dark"].includes(q)?Ct:void 0});
